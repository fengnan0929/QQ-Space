<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>留言-闲言轻博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="res/layui/css/layui.css">
    <link rel="stylesheet" href="res/static/css/mian.css">
</head>
<body class="lay-blog">
<div class="header">
    <div class="header-wrap">
        <h1 class="logo pull-left">
            <a href="index.html">
                <img src="res/static/images/logo.png" alt="" class="logo-img">
                <img src="res/static/images/logo-text.png" alt="" class="logo-text">
            </a>
        </h1>
        <form class="layui-form blog-seach pull-left" action="">
            <div class="layui-form-item blog-sewrap">
                <div class="layui-input-block blog-sebox">
                    <i class="layui-icon layui-icon-search"></i>
                    <input type="text" name="title" lay-verify="title" autocomplete="off" class="layui-input">
                </div>
            </div>
        </form>
        <div class="blog-nav pull-right">
            <ul class="layui-nav pull-left">
                <li class="layui-nav-item"><a href="index.html">首页</a></li>
                <li class="layui-nav-item  layui-this"><a href="message.html">留言</a></li>
                <li class="layui-nav-item"><a href="about.html">关于</a></li>
            </ul>
            <a href="#" class="personal pull-left  layui-nav-item exit" style="font-size: 16px;">
                <i class="layui-icon layui-icon-username"></i>
                退出
            </a>
        </div>
        <div class="mobile-nav pull-right" id="mobile-nav">
            <a href="javascript:;">
                <i class="layui-icon layui-icon-more"></i>
            </a>
        </div>
    </div>
    <ul class="pop-nav" id="pop-nav">
        <li><a href="index.html">首页</a></li>
        <li><a href="message.html">留言</a></li>
        <li><a href="about.html">关于</a></li>
    </ul>
</div>
<div class="bg">
    <div class="bg-wrap">
        <div class="self-intro">
            <span class="head-pic"></span>
            <span class="nick">春风吻我像蛋挞</span>
        </div>
    </div>
</div>
<div class="container-wrap">
    <div class="container container-message">
        <div class="contar-wrap" id="contar-wrap">
            <form class="layui-form" action="">
                <div class="layui-form-item layui-form-text">
                    <textarea class="layui-textarea" id="LAY-msg-content" style="resize:none"></textarea>
                </div>
            </form>
            <div class="item-btn">
                <button class="layui-btn layui-btn-normal" id="item-btn">提交</button>
            </div>

            <div id="LAY-msg-box">
                <!--<div class="info-box">
                    <div class="info-item">
                        <img class="info-img" src="res/static/images/info-img.png" alt="">
                        <div class="info-text">
                            <p class="title count">
                                <span class="name">一片空白</span>
                                <span class="info-img like"><i class="layui-icon layui-icon-praise"></i>0</span>
                            </p>
                            <p class="info-intr">
                                父爱如山，不善表达。回想十多年前，总记得父亲有个宽厚的肩膀，小小的自己跨坐在上面，越过人山人海去看更广阔的天空，那个时候期望自己有一双翅膀，能够像鸟儿一样飞得高，看得远。虽然父亲有时会和自己开玩笑，但在做错事的时候会受到严厉的训斥。父亲有双粗糙的大手掌。</p>
                        </div>
                    </div>
                </div>-->
            </div>

            <div id="test1" class="paging"></div>
        </div>
    </div>
</div>
<div class="footer">
    <p>
        <span>&copy; 2018</span>
        <span><a href="http://www.layui.com" target="_blank">浙江大学软件学院</a></span>
        <span>S403</span>
    </p>
    <p><span>人生就是一场修行，祝君猪事顺利</span></p>
</div>
</div>
<script src="res/layui/layui.js">

</script>

<script id="LAY-msg-tpl" type="text/html">
    <div class="info-box">
        <div class="info-item">
            <img class="info-img" src={{ d.avatar }} alt="" style="width: 70px;height: 70px;">
            <div class="info-text">
                <p class="title count">
                    <span class="name">{{ d.username }}</span>
                    <span class="info-img like">
				  	<i class="layui-icon layui-icon-praise"></i>
				  	{{ d.praise }}
				 	</span>
                </p>
                <p class="info-intr">
                    {{ d.content }}
                </p>
            </div>
        </div>
    </div>
</script>
<script>
    layui.config({
        base: 'res/static/js/'
    }).use('blog');
</script>
<script src="res/jquery/jquery-1.12.4.js"></script>
<script>
    $(function () {
        $.get("",function (data) {
            localStorage.setItem("messages",data);  //并不确定data是否要用stringily()转成json字符串,字符串对象用Json.parse()转换
        });

        let messages =[{'nick':"小可爱",'headpic':"res/layui/images/face/100.jpeg","like":"10","text":"封楠的小可爱又来给她留言啦～"},{'nick':"小可爱",'headpic':"res/layui/images/face/1.gif","like":"10","text":"封楠的小可爱来给她留言啦～"},{'nick':"wl",'headpic':"res/layui/images/face/100.jpeg","like":"5","text":"我的人生乐趣之一就是逗go鸭生气"},{'nick':"小可爱",'headpic':"res/layui/images/face/102.jpg","like":"10","text":"小wl不会给封楠留言的啦～"},{'nick':"小可爱",'headpic':"res/layui/images/face/3.gif","like":"10","text":"封楠的小可爱第一次来给她留言啦～"}];
        // 初始化用户信息
        let data = JSON.parse(localStorage.getItem('pdata'));

        $('.head-pic').css({
            background: data.headpic + ' center center',
            backgroundSize: "100%"
        });
        $('.nick').text(data.nickname);

        // 退出跳转
        $('.exit').on("click", function () {
            if (confirm("您确认要退出闲言吗？") == true) {
                $(window).attr('location', 'login.html');
                localStorage.removeItem("data");
                localStorage.removeItem("pdata");
            }
        });

        // 初始化页面内容
        function updateContent(messages){
            let content = " ";
            for(let i=0; i<messages.length; i++){
                content = content +`<div class="info-box">
                    <div class="info-item">
                        <img class="info-img" src="${messages[i].headpic}" style="width: 70px;height: 70px;" alt="">
                        <div class="info-text">
                            <p class="title count">
                                <span class="name">${messages[i].nick}</span>
                                <span class="info-img like "><i class="layui-icon layui-icon-praise"></i>${messages[i].like}</span>
                            </p>
                            <p class="info-intr">${messages[i].text}</p>
                        </div>
                    </div>
                </div>`
            }
            $('#LAY-msg-box').html(content);
        }
        updateContent(messages);
    })
</script>

</body>
